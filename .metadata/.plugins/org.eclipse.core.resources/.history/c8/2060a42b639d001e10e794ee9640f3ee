package com.cc.service;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.cc.dto.CoinDto;
import com.cc.entites.Coins;
import com.cc.exception.CoinException;
import com.cc.repository.CoinRepository;


@Service
public class CoinServiceImpl implements CoinService {
	
	@Autowired
	CoinRepository coinRepository;

	@Override
	public Coins getCoinById(Integer id) throws CoinException {
		return coinRepository.findById(id).get();
	}

	@Override
	public Coins addCoin(CoinDto coindto) throws CoinException {
		Coins coin = new Coins();
		coin.setCryptoName(coindto.getName());
		coin.setPrice(Double.parseDouble(coindto.getPrice()));
		coin.setUuid(coindto.getUuid());
		coin.setSymbol(coindto.getSymbol());
		coin.setColor(coindto.getColor());
		coin.setIconUrl(coindto.getIconUrl());
		coin.setMarketCap(coindto.getMarketCap());
		coin.setListedAt(coindto.getListedAt());
		coin.setTier(coindto.getTier());
		coin.setChange(coindto.getChange());
		coin.setRank(coindto.getRank());
		coin.setCoinRankingUrl(coindto.getCoinrankingUrl());
		coin.setBtcPrice(coindto.getBtcPrice());
		
		return coinRepository.save(coin);
	}

	@Override
	public List<Coins> addCoins(List<CoinDto> coins) throws CoinException {
		for (CoinDto i : coins) {
			Coins coin = new Coins();
			coin.setCryptoName(i.getName());
			coin.setPrice(Double.parseDouble(i.getPrice()));
			coin.setUuid(i.getUuid());
			coin.setSymbol(i.getSymbol());
			coin.setColor(i.getColor());
			coin.setIconUrl(i.getIconUrl());
			coin.setMarketCap(i.getMarketCap());
			coin.setListedAt(i.getListedAt());
			coin.setTier(i.getTier());
			coin.setChange(i.getChange());
			coin.setRank(i.getRank());
			coin.setCoinRankingUrl(i.getCoinrankingUrl());
			coin.setBtcPrice(i.getBtcPrice());
			coinRepository.save(coin);
		}
		return coins;
	}

	@Override
	public Coins deleteCoinById(Integer id) throws CoinException {
		Coins coin = getCoinById(id);
		coinRepository.deleteById(id);
		return coin;
	}

	@Override
	public List<Coins> getAllCoins() throws CoinException {
		return coinRepository.findAll();
	}

}
